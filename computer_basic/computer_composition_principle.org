* 第一章
** 习题
1. 什么是存储容量? 什么是单元地址? 什么是数据字? 什么是指令字?
   - 存储容量: 存储器所有存储单元的总数
   - 单元地址: 每个存储单元的编号
   - 数据字: 如果某字代表要处理的数据
   - 指令字: 如果某字为一条指令
2. 指令和数据均存放在内存中, 计算机是如何区分它们是指令还是数据?
   通过不同类型的周期区分:
   - 取指周期: 从内存读出的信息流是指令流
   - 执行周期: 从内存读出的信息流是数据流
3. 为什么软件能够转化为硬件, 硬件能够转化为软件? 实现这种转化的媒介是什么?

   任何操作可以由软件来实现, 也可以由硬件来实现; 任何指令的执行可以由硬件完成, 也可以由软件来完成

   实现这种转化的媒介是软件与硬件的逻辑等价性
4. CPU 的性能指标有那些? 其概念是什么
   - 吞吐量: 表征一台计算机在某一时间间隔内能够处理的信息量
   - 响应时间: 表征从输入有效到系统产生响应之间的时间度量
   - 利用率: 在给定的时间间隔内系统被实际使用的时间所占的比率
   - 处理机字长: 指处理机运算器中一次能够完成二进制数运算的位数
   - 总线宽度: 一般指 CPU 中运算器与存储器之间进行互连的内部总线二进制位数
   - 存储器容量: 存储器中所有存储单元的总数
   - 存储器带宽: 单位时间内从存储器读出的二进制数信息量
   - 主频/时钟周期: CPU 的工作节拍受主时钟控制, 主时钟不断产生固定频率的时钟
   - CPU 执行时间: 表示 CPU 执行一般程序所占用的 CPU 时间
   - CPI: 表示每条指令周期数
   - MIPS: Million Instructions Per Second
   - FLOPS: Floating-point Operations Per Second

* 第二章
** 习题
1. 有一个字长为 32 位的浮点数, 符号位 1 位; 阶码 8 位, 用移码表示; 尾数 23 位, 用补码表示; 基数为 2。请写出:
   - 最大数的二进制表示: 1 11111111 01111111111111111111111
   - 最小数的二进制表示: 1 11111111 10000000000000000000000
   - 规格化数所能表示的数的范围:
2. 已知 x 和 y, 用变形补码计算 x+y, 同时指出结果是否溢出
   1) x=11011, y=00011
      #+BEGIN_EXAMPLE
        x(补)=00 11011, y(补)=00 00011
         00 11011
        +00 00011
        ---------
         00 11110
        结果没有溢出, x+y=11110
      #+END_EXAMPLE
   2) x=11011, y=-10101
      #+BEGIN_EXAMPLE
        x(补)=00 11011, y(补)=11 01011
         00 11011
        +11 01011
        ---------
         00 00110
        结果没有溢出, x+y=00110
      #+END_EXAMPLE
   3) x=-10110, y=-00001
      #+BEGIN_EXAMPLE
        x(补)=11 01010, y(补)=11 111111
         00 01010
        +00 11111
        ---------
         11 01001
        结果没有溢出, x+y=-10111
      #+END_EXAMPLE
3. 已知 x 和 y, 用变形补码计算 x-y, 同时指出结果是否溢出
   1) x=11011, y=-11111
      #+BEGIN_EXAMPLE
        x(补)=00 11011, -y(补)=00 11111
         00 11011
        +00 11111
        ---------
         01 11010
        结果有正溢出, x-y=11010
      #+END_EXAMPLE
   2) x=10111, y=11011
      #+BEGIN_EXAMPLE
        x(补)=00 10111, -y(补)=11 00101
         00 10111
        +11 00101
        ---------
         11 11100
        结果没有溢出, x-y=00100
      #+END_EXAMPLE
   3) x=11011, y=-10011
      #+BEGIN_EXAMPLE
        x(补)=00 11011, -y(补)=00 10011
         00 11011
        +00 10011
        ---------
         01 01110
        结果有正溢出, x-y=10010

      #+END_EXAMPLE
4. 用 IEEE 32 位浮点格式表示如下的数
   1) -5: 1 10000001 01000000000000000000000
   2) -1.5: 1 01111111 10000000000000000000000
   3) 384: 0 10000111 10000000000000000000000
   4) 1/16: 0 01111011 00000000000000000000000
   5) -1/32: 0 01111010 00000000000000000000000
5. 下列各数使用了 IEEE 32 位浮点格式, 相等的十进制是什么?
   1) 1 10000011 110 0000 0000 0000 0000 0000: -28
   2) 0 01111110 101 0000 0000 0000 0000 0000: 0.8125
* 第三章
1. 设一个具有 20 位地址和 32 位字长的存储器, 问:
   1) 该存储器能存储多少个字节的信息?

      $2^{20}\times\frac{32}{8}=4M$ 字节
   2) 如果存储器由 512K x 8 位 SRAM 芯片组成, 需要多少片?

      $\frac{1024K\times{32}}{512K\times{8}}=2\times{4}=8$ 片
   3) 需要多少位地址作芯片选择?
      
      1 位地址作芯片选择
2. 已知某 64 位机主存采用半导体存储器, 其地址码为 26 位, 若使用 4M x 8 位的 DRAM 芯片组成该机所允许的最大主存空间, 并选用内存条结构形式, 问:
   1) 若每个内存条为 16M x 64 位, 共需几个内存条?

      $\frac{2^{26}}{2^{24}}=4$ 块
   2) 每个内存条内共有多少 DRAM 芯片?

      $\frac{2^{24}}{2^{22}}\times{\frac{64}{8}}=32$ 片
   3) 内存共需多少 DRAM 芯片? CPU 如何选择各内存条?

      主存共需要 DRAM 芯片为: $4\times{32}=128$ 片
      A23-A0 完成内存条內存储单元寻址, A25-A24 通过 2:4 译码器进行片选
3. 用 32K x 8 的 E^{2}PROM 芯片组成 128K x 16 位的只读存储器, 试问:
   1) 数据寄存器多少位? 16 位
   2) 地址寄存器多少位? 系统地址 $128K=2^{17}$, 所以地址寄存器 17 位
   3) 共需多少个 E^{2}PROM 芯片? 8 片
   4) 画出此存储器组成框图。
      [[file:image/screenshot_2018-10-31_09-52-15.png]]
4. 设存储器容量为 64M, 字长为 64 位, 模块数 m=8, 分别用顺序和交叉方式进行组织。存储周期 T=100ns, 数据总线宽度位 64 位, 总线传送周期 $\tau=50ns$ 。求: 顺序存储器和交叉存储器的带宽是多少?

   信息总量: $q=64\times{8}=512$ 位

   顺序存储器和交叉存储器连续读出 8 个字所需的时间分别是:
   #+BEGIN_SRC latex :results raw :exports none
     \begin{align}
       t_{1}&=mT=8\times{100ns}=8\times{10^{-7}}s\\
       t_{2}&=T+(m-1)\tau=100ns+7\times{50ns}-450ns=4.5*10^{-7}ns
     \end{align}
   #+END_SRC 
   #+RESULTS:
   \begin{align}
     t_{1}&=mT=8\times{100ns}=8\times{10^{-7}}s\\
     t_{2}&=T+(m-1)\tau=100ns+7\times{50ns}-450ns=4.5*10^{-7}ns
   \end{align}

   顺序存储器和交叉存储器的带宽分别为:

   #+BEGIN_SRC latex :results raw :exports none
     \begin{align}
       W_{1}=\frac{q}{t_{1}}=\frac{512}{8\times{10^{-7}}}=64\times{10^{7}}\\
       W_{2}=\frac{q}{t_{2}}=\frac{512}{4.5\times{10^{-7}}}=113.8\times{10^{7}}
     \end{align}
   #+END_SRC 
   #+RESULTS:
   \begin{align}
     W_{1}=\frac{q}{t_{1}}=\frac{512}{8\times{10^{-7}}}=64\times{10^{7}}\\
     W_{2}=\frac{q}{t_{2}}=\frac{512}{4.5\times{10^{-7}}}=113.8\times{10^{7}}
   \end{align}
5. CPU 执行一段程序时, cache 完成存取的次数为 2420 次, 主存完成存取的次数为 80 次, 已知 cache 存储周期位 40ns, 主存存储周期为 240ns, 求 cache/主存系统的效率和平均访问时间。

   cache 的命中率:

   #+BEGIN_SRC latex :results raw :exports none
     \begin{align}
       H&=\frac{N_{c}}{N_{c}+N_{m}}=\frac{2420}{2420+80}=0.968\\
       r&=\frac{T_{m}}{T_{c}}=\frac{240}{40}=6
     \end{align}
   #+END_SRC 

   #+RESULTS:
   \begin{align}
     H&=\frac{N_{c}}{N_{c}+N_{m}}=\frac{2420}{2420+80}=0.968\\
     r&=\frac{T_{m}}{T_{c}}=\frac{240}{40}=6
   \end{align}

   cache/主存系统效率 $e$ 为:

   #+BEGIN_SRC latex :results raw :exports none
     \begin{equation}
       e=\frac{1}{r+(1-r)H}\times{100\percent}=\frac{1}{6+(1-6)\times{0.968}}\times{100\percent}=86.2\percent
     \end{equation}
   #+END_SRC 

   #+RESULTS:
   \begin{equation}
     e=\frac{1}{r+(1-r)H}\times{100\percent}=\frac{1}{6+(1-6)\times{0.968}}\times{100\percent}=86.2\percent
   \end{equation}

   平均访问时间 $T_{a}$ 为:

   #+BEGIN_SRC latex :results raw :exports none
     \begin{equation}
       T_{a}=\frac{T_{c}}{e}=\frac{40ns}{0.862ns}=46.4ns
     \end{equation}
   #+END_SRC 

   #+RESULTS:
   \begin{equation}
     T_{a}=\frac{T_{c}}{e}=\frac{40ns}{0.862ns}=46.4ns
   \end{equation}
6. 已知 cache 存储周期 40ns, 主存存储周期 200ns, cache/主存系统平均访问时间为 50ns, 求 cache 的命中率多少?
   
   #+BEGIN_SRC latex :results raw :exports none
     \begin{align}
       h\times{t_{c}}+(1-h)\times{t_{m}}&=t_{a}\\
       h=\frac{t_{a}-t_{m}}{t_{c}-t_{m}}=\frac{50-200}{40-200}=93.75\percent
     \end{align}
   #+END_SRC 

   #+RESULTS:
   \begin{align}
     h\times{t_{c}}+(1-h)\times{t_{m}}&=t_{a}\\
     h=\frac{t_{a}-t_{m}}{t_{c}-t_{m}}=\frac{50-200}{40-200}=93.75\percent
   \end{align}
* 第四章
1. 假设某计算机指令长度位 32 位, 具有双操作数、单操作数、无操作数三类指令形式, 指令系统共有 70条指令, 请设计满足要求的指令格式。
   - 双操作数指令格式: 7 12 12
   - 单操作数指令格式: 7 25 -
   - 无操作数指令格式: 7 - -
2. 根据操作数所在位置, 指出其寻址方式:
   1) 操作数在寄存器中, 为 *寄存器* 寻址方式。
   2) 操作数地址在寄存器, 为 *寄存器间接* 寻址方式。
   3) 操作数在指令中, 为 *立即* 寻址方式。
   4) 操作数地址(主存)在指令中, 为 *直接* 寻址方式。
   5) 操作数地址, 为某一寄存器内容与位移量之和, 可以是 *相对、基址、变址* 寻址方式。
* 第五章
1. 参见图 5.1 的数据通路, 画出存数指令 "=STO R1, (R2)=" 的指令周期流程图, 其含义是将寄存器 $R_{1}$ 的内容传送至 $(R_{2})$ 为地址的数存单元中。标出各微操作信号序列。
   [[file:image/screenshot_2018-11-21_09-36-58.png]]
2. 今有 4 级流水线, 分别完成取指、指令译码并取数、运算、送结果四步操作, 令假设完成各步操作的时间依次为 100ms, 100ns, 80ns, 50ns。请问:
   1) 流水线的操作周期应设计为多少?
      $$\tau=max\{\tau_{i}\}=100ns$$
   2) 若相邻两条指令发生数据相关, 硬件上不采取措施, 那么第 2 条指令要推迟多少时间进行?
      
      至少延迟 2 个时钟周期
   3) 如果在硬件设计上加以改进, 至少需推迟多少时间?

      采用专用通路技术, 就可使流水线不发生停顿
3. 指令流水线有取值(IF)、译码(ID)、执行(EX)、访存(MEM)、写回寄存器堆(WB)五个过程段, 共有 20 条指令连续输入此流水线。
   1) 画出流水处理的时空图, 假设时钟周期为100ns。
     [[file:image/screenshot_2018-11-21_09-32-43.png]]
   2) 求流水线的实际吞吐率(单位时间里执行完毕的指令数)。
      $$H=\frac{n}{(K+n-1)\tau}=\frac{20}{(5+20-1)*100*10^{-9}}=8.33*10^{6}$$
   3) 求流水线的加速比
      $$S=\frac{T_{S}}{T_{P}}=\frac{n\tau K}{(K+n-1)\tau}=\frac{20*5}{20+5-1}=4.17$$
4. 判断以下三组指令中各存在那种类型的数据相关。
   1) 写后读 =RAW=
      #+BEGIN_EXAMPLE
        I1 LDA R1, A  ; M(A)->R1, M(A) 是存储器单元
        I2 ADD R2, R1 ; (R2)+(R1)->R2
      #+END_EXAMPLE
   2) 读后写 =WAR=
      #+BEGIN_EXAMPLE
        I3 ADD R3, R4 ; (R3)+(R4)->R3
        I4 MUL R4, R5 ; (R4)x(R5)->R4
      #+END_EXAMPLE
   3) 写后写 =WAW=
      #+BEGIN_EXAMPLE
        I5 LDA R6, B  ; M(B)->R6, M(B) 是存储器单元
        I6 MUL R6, R7 ; (R6)x(R7)->R6
      #+END_EXAMPLE
* 第六章
1. 说明总线结构对计算机性能的影响
   - 简化了硬件设计
   - 简化了系统结构
   - 系统扩展性好
   - 系统更新性能好
2. 画出菊花链方式的优先级判决逻辑电路图
   [[file:image/screenshot_2018-11-28_08-36-04.png]]
3. 画出独立请求方式的优先级判决逻辑电路图
   [[file:image/screenshot_2018-11-28_08-46-25.png]]
4. PCI 总线中三种桥的名称是什么? 它们的功能是什么?
   - 名称: HOST 桥、PCI/LAGACY 总线桥、PCI/PCI 桥
   - 功能: 
     - 它连接两条总线, 使彼此间相互通信。
     - 桥是一个总线转换部件, 可以把一条总线的地址空间映射到另一条总线的地址空间上, 从而使系统中任意一个总线主设备都能看到同样的一份地址表。
     - 桥可以实现总线间的猝发式传送, 可使所有的存取都按 CPU 的需要出现在总线上。
5. 比较 PCI 总线和 InfiniBand 标准的性能特点
   分布式仲裁不需要中央仲裁器, 每个潜在的主方功能模块都有自己的仲裁号和仲裁器。当它们有总线请求时, 把它们唯一的仲裁号发送到共享的仲裁总线上, 每个仲裁器将仲裁总线上得到的号与自己的号进行比较。如果仲裁总线上的号大, 则它的总线请求不予响应, 并撤消它的仲裁号。最后, 获胜者的仲裁号保留在仲裁总线上, 分布式仲裁是以优先级仲裁策略为基础。
* 第七章
1. 一光栅扫描图形显示器, 每帧有 1024x1024 像素, 可以显示 256 种颜色, 问刷新存储器容量至少需要多少?
   $$\frac{1024\times1024\times256}{8\times8}=1MB$$
2. 一个双面 CD-ROM 光盘, 每面有 100 道, 每道 9 个扇区, 每个扇区存储 512B, 请求出光盘格式化容量?
   格式化容量=扇区容量x每道扇区数x磁道总数
   $$512\times9\times100\times2=921600B$$
3. 已知某磁盘存储器转速为 2400 转/分, 每个记录面道数为 200 道, 平均找道时间为 60ms, 每道存储容量为 96kb, 求磁盘的存储时间与数据传输率。
   存取时间=平均查找时间+平均等待时间
   $$60+\frac{1}{2}\times\frac{60}{2400}\times1000=72.5ms$$
   $$Dr=96\times\frac{2400}{60}=480KB/s$$
4. 刷新存储器的重要性能指标是它的带宽。若显示工作方式采用分辨率为 1024x768, 颜色深度为 24 位, 帧频(刷新速率)为 72 Hz, 求:
   1) 刷新存储器的存储容量是多少?
      $$1024\times768\times3=2.25MB$$
   2) 刷新存储器的带宽是多少?
      $$1024\times768\times3B\times72/s=162MB/s$$
      
* 第八章
1. 在图 8.9 中当 CPU 对设备 B 的中断请求进行服务, 如设备 A 提出请求, CPU 能够响应吗? 为什么? 如果设备 B 一提出请求总能立即得到服务, 问怎么调整才能满足此要求?

   能响应, 因为设备 A 的优先级比设备 B 高。若要设备 B 总能立即得到服务, 可将设备 B 从第二级取出来, 单独放在第三级上, 使第三级的优先级最高,即令 $IM_{3}=0$ 。

2. 在图 8.9 中, 假定 CPU 取指并执行一条指令的时间为 $t_{1}$, 保护现场需 $t_{2}$, 恢复现场需 $t_{3}$, 中断周期需 $t_{4}$, 每个设备的设备服务时间为 $t_{A},t_{B},\cdots,t_{G}$ 。试计算只有设备 A, D, G 时的系统中断饱和时间。

   依次处理设备 A, D, G 的时间 $T$ 为:
   #+BEGIN_SRC latex :results raw :exports none
     \begin{align}
       T_{1}&=t_{1}+t_{2}+t_{3}+t_{4}+t_{A}\\
       T_{2}&=t_{1}+t_{2}+t_{3}+t_{4}+t_{D}\\
       T_{3}&=t_{1}+t_{2}+t_{3}+t_{4}+t_{G}\\
       T&=T_{1}+T_{2}+T_{3}=3*(t_{1}+t_{2}+t_{3}+t_{4})+t_{A}+t_{D}+t_{G}
     \end{align}
   #+END_SRC 

   #+RESULTS:
   \begin{align}
     T_{1}&=t_{1}+t_{2}+t_{3}+t_{4}+t_{A}\\
     T_{2}&=t_{1}+t_{2}+t_{3}+t_{4}+t_{D}\\
     T_{3}&=t_{1}+t_{2}+t_{3}+t_{4}+t_{G}\\
     T&=T_{1}+T_{2}+T_{3}=3*(t_{1}+t_{2}+t_{3}+t_{4})+t_{A}+t_{D}+t_{G}
   \end{align}

3. 用多路 DMA 控制器控制光盘、软盘、打印机三个设备同时工作。光盘以 $20\mu s$ 的间隔向控制器发 DMA 请求, 软盘以 $90\mu s$ 的间隔向控制器发 DMA 请求, 打印机以 $180\mu s$ 的间隔向控制器发 DMA 请求, 请画出多路 DMA 控制器的工作时空图。

* review
#+caption: 填空题
1. 数的真值变成机器码可采用 =原码, 补码, 反码, 移码= 表示法。
2. 移码表示法主要用于表示 =浮点= 数的阶码 E, 以利于比较两个 =指数= 的大小和 =对阶= 操作。
3. 一个定点数由 =符号位= 和 =数值域= 两部分组成。根据小数点位置不同, 定点数有纯小数和 =纯整数= 两种表示方式。
4. 为了实现运算器的 =高速性=, 采用了 =先行= 进位、 =阵列= 乘除法等并行技术。
5. 计算机对存储器的要求是 =容量大、速度快、成本低= 为了解决这方面的矛盾, 计算机采用多级存储体系结构。
6. 双端口存储器和多模块交叉存储器属于 =并行= 存储器结构。前者采用 =空间并行= 技术, 后者采用 =时间并行= 技术。
7. 指令格式中, 地址码字段是通过 =寻址方式= 来体现的, 因为通过某种方式的变换, 可以给出 =操作数有效= 地址。
8. 形成指令地址的方式, 称为 =指令寻址= 有 =顺序= 寻址和 =跳跃= 寻址。
9. CPU 从 =存储器= 取出一条指令并执行这条指令的时间和称为 =指令周期= 。由于各种指令的操作功能不同, 各种指令的指令周期是 =不相同的= 。
10. CPU 周期也称为 =机器周期= 。一个 CPU周期包含若干个 =时钟周期= 。任何一条指令的指令周期至少需要 =2 个= CPU 周期。
11. 硬布线控制器的基本思想是: 某个微操作控制信号是 =指令操作码= 移码输出, =时序= 信号和 =状态条件= 信号的逻辑函数。
12. 微程序设计是利用 =软件= 方法设计 =操作控制= 的一门技术。具有规整型、可维护性、 =灵活性= 等一系列优点。
13. 在计算机系统中, 多个系统部件之间信息传送的公共通路称为 =总线= 。就其所传送信息的性质而言, 在公共通路上传送的信息包括数据、 =地址= 、 =控制= 信息。
14. 为了解决多个 =主设备= 同时竞争总线, =控制权= 必须具有 =总线仲裁= 部件。
15. 并行处理技术已经成为计算家发展的主流。它可贯穿与信息加工的各个步骤和阶段概括起来，主要有三种形式 =时间并行、空间并行、时间+空间并行= 。
16. 中断处理需要有中断 =优先级仲裁=, 中断 =向量= 产生, 中断 =控制逻辑= 等硬件支持。
17. 定点运算器的结构主要有: =单总线、双总线、三总线= 运算器。
18. CPU 的控制器可以根据指令的 =操作性质= 和 =寻址方式= 形成操作数的地址。
19. 指令流向的控制即 =下条指令地址= 的形成控制。
20. 硬布线控制器, 它是采用 =时序逻辑= 技术来实现的。
21. 微程序控制器是采用 =存储逻辑= 来实现的
22. 衡量总线性能的重要指标是 =总线带宽=, 它定义为总线本身所能达到的最高 =传输速率= 。PCI 总线的带宽可达 =264MB/s=


** 运算方法和运算器
原码、反码、补码、移码

